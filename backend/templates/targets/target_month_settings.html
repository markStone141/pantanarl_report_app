{% extends "base.html" %}

{% block title %}月目標設定 | 管理者ページ{% endblock %}

{% block content %}
<div class="container">
  <header class="topbar">
    <div>
      <strong>月目標設定</strong>
      <div class="muted" style="color: #e1f1f5;">部門ごとの目標件数と目標金額を月単位で保存します。</div>
    </div>
    <nav>
      <a href="{% url 'target_index' %}">目標ダッシュボード</a>
      <a href="{% url 'target_period_settings' %}">路程設定</a>
      <a href="{% url 'home' %}" class="logout-link">ログアウト</a>
    </nav>
  </header>

  <section class="card" style="margin-top: 16px;">
    <h3>月目標入力</h3>
    {% if saved %}
    <div class="notice" style="margin: 10px 0;">月目標を保存しました。</div>
    {% endif %}
    <form method="post">
      {% csrf_token %}
      <input type="hidden" name="action" value="save_month_targets" />
      <div class="row">
        <span class="badge">対象月: {{ selected_month_label }}</span>
        <input name="month" type="month" value="{{ selected_month }}" style="max-width: 180px;" />
      </div>

      <table style="margin-top: 10px;">
        <thead>
          <tr><th>部門</th><th>目標件数</th><th>目標金額</th></tr>
        </thead>
        <tbody>
          {% for row in rows %}
          <tr>
            <td>{{ row.label }}</td>
            <td><input type="number" min="0" name="count_{{ row.code }}" value="{{ row.count }}" /></td>
            <td><input type="number" min="0" name="amount_{{ row.code }}" value="{{ row.amount }}" /></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <div style="margin-top: 10px;"><button type="submit">月目標を保存</button></div>
    </form>
  </section>

  <section class="card" style="margin-top: 16px;">
    <h3>過去の月目標（件数）</h3>
    {% if recent_month_rows %}
    <table>
      <thead>
        <tr><th>対象月</th><th>UN</th><th>WV</th><th>Style1</th><th>Style2</th></tr>
      </thead>
      <tbody>
        {% for row in recent_month_rows %}
        <tr>
          <td>{{ row.month_label }}</td>
          <td>{{ row.UN }}</td>
          <td>{{ row.WV }}</td>
          <td>{{ row.STYLE1 }}</td>
          <td>{{ row.STYLE2 }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p class="muted">保存済みの月目標はまだありません。</p>
    {% endif %}
  </section>
</div>
{% endblock %}
